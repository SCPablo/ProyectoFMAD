---
title: "Proyecto FMAD"
subtitle: ICAI. Máster en Big Data. Fundamentos Matemáticos del Análisis de Datos
  (FMAD).
date: 'Curso 2021-22. Última actualización: `r format(Sys.time(), "%Y-%m-%d")`'
linestretch: "1.25"
header-includes:
  \usepackage[spanish]{babel}
output:
  pdf_document: default
  html_document: default
---

\begin{center}
\includegraphics{logoicai.png}
\end{center}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newpage
\tableofcontents
\newpage


# Introducción

Cargamos las librerías
```{r, echo = FALSE, warning=FALSE,message=FALSE}
library(tidyverse)
```

Leemos los datos
```{r}
datos <- read.csv("marketing_campaign.csv", header = TRUE, sep = "")
head(datos)
```

\newpage

# Definición de las variables

- **ID**: El ID del cliente.

- **Year_Birth:** Año de nacimiento.

- **Education:** Nivel de educación del cliente.

- **Marital_Status:** Estado civil del cliente.

- **Income:** Ingreso familiar anual del cliente.

- **Kidhome:** Número de niños pequeños en casa del cliente.

- **Teenhome:** Número de adolescentes en el hogar del cliente.

- **Dt_Customer:** Fecha de inscripción del cliente en la empresa.

- **Recency:** Número de días desde la última compra.

- **MntWines:** Gasto en productos vitivinícolas en los últimos 2 años.

- **MntGoldProds:** Gasto en productos **"premium"??** en los últimos 2 años.

- **NumDealsPurchases:** Número de compras con uso de descuento.

- **NumWebPurchases:** Número de compras a través de la web.

- **NumCatalogPurchases:** Número de compras usando catalogo.

- **NumWebVisitsMonth:** **¿¿¿¿Dicen que es lo mismo que las compras a traves de la web??? Pero no seria visitas por mesa la web** 

- **AcceptedCmp1:** 1 si el cliente acepta la oferta en la 1ra campaña, 0 si no lo acepta.

- **AcceptedCmp2:** 1 si el cliente acepta la oferta en la 2nd campaña, 0 si no lo acepta.

- **Complain:** 1 si el cliente se ha quejado en los dos últimos años.

- **Z_CostContact:** Coste de contactar con cliente.

- **Z_Revenue:** Ingresos/Beneficios después de que el cliente acepte la campaña

- **Response:** 1 si el cliente acepta la oferta en la última campaña y 0 si no la acepta.


\newpage

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

\newpage

# TODO Resumen de datos
```{r}
cat(cat(cat(cat("El conjunto de datos tiene", nrow(datos)), "filas y"), ncol(datos)), "columnas")
head(datos)
```
Hay 2 columnas al final: "Z_CostContact" y "Z_Revenue" que no sé qué son.

\newpage


# TODO Preprocesamiento de los datos
En esta sección haría los siguientes cambios para dejar un datasets más simple.
Por un lado cogería las columnas "NumWebPurchases", "NumCatalogPurchases" y "NumStorePurchases" que indican el lugar por donde se han hecho las ofertas a cada cliente y las sumaría todas en una única columna que indique el número de ofertas totales que ha recibido el cliente.
```{r}
datos %>%
  replace(is.na(.), 0) %>%
  rowwise(ID) %>%
  mutate(suma_ofertas = sum(c(NumWebPurchases, NumStorePurchases)))
```


Por otro lado trataría las columnas: "AcceptedCmp1", "AcceptedCmp2", "AcceptedCmp3", "AcceptedCmp4" y "AcceptedCmp5". que indican si el cliente aceptó la oferta i-ésima.
La columna "Response" indica si el cliente aceptó la última oferta.
Cogería todas esas columnas y las sumaría y dejaría una única que indique el número de ofertas que ha aceptado el cliente de las últimas 6.
Con todas estas columnas habría que pivotar y dejar una única columa que sea en el primer grupo: lugar, y en el segundo una columna que sea la oferta que se aceptó.
Si no se pone la oferta i indica que no se aceptó.






Aquí tengo mis dudas. Con las siguiente columans: "MntWines", "MntFruits", "MntMeatProducts",  "MntFishProducts",  "MntSweetProducts",  "MntGoldProds" que marcan la cantidad de dinero que se ha gastado cada cliente en un tipo de producto.

\newpage

# TODO Visualización de los datos
# TODO Buscar la relación posible entre distintas variable
# TODO Realizar algún modelo predictivo sobre variables target como el 'complain' 
# TODO Convertir a booleana la variable target

Preprocesamiento de los datos
```{r}

```

